/***************************************
* @license
* Built December 02, 17 23:37:02
* Version: 0.1.9
* Minor version: jssdk-rc-0.1.8.151
***************************************/
("undefined"!=typeof _aurycDefine?_aurycDefine:define)(["require","_auryc","aurycConfig",_aurycNormalizeUrl("core/userty.utils.js"),_aurycNormalizeUrl("core/userty.behavior.js"),_aurycNormalizeUrl("feedback/userty.templates.default.js")],function(e,t,aurycConfig,i,s,o){function n(e,t,s){if(h[e])return h[e].success.subscribe(t||function(){},!0,!0),void h[e].fail.subscribe(s||function(){},!0,!0);var o,n,r,a=!1;this.count=this.count?++this.count:1,o=this.count,n="load-css-"+o,r=document.createElement("link"),r.setAttribute("id",n),r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css");var c={link:r,url:e,didfail:!1,didsucceed:!1,success:new i.AurycEvent,fail:new i.AurycEvent};return c.success.subscribe(t,!0,!0),c.fail.subscribe(s,!0,!0),h[e]=c,"undefined"!=typeof r.addEventListener?(r.addEventListener("load",function(){a=!0,c.didsucceed=!0,c.success.fire(r)},!1),r.addEventListener("error",function(){c.didfail=!0,c.fail.fire(r)},!1)):"undefined"!=typeof r.attachEvent&&r.attachEvent("onload",function(){var e,t,i=document.styleSheets.length;try{for(;i--;)if(t=document.styleSheets[i],t.id===n)return e=t.cssText,a=!0,c.didsucceed=!0,void c.success.fire(r)}catch(s){}a||(c.didfail=!0,c.fail.fire(r))}),document.getElementsByTagName("head")[0].appendChild(r),r.setAttribute("href",e),r}function r(e,t){var s=i.globalSessionTracker.getSessionMetadata().globalSessionId,o=w.get("TTF_"+e+"_"+t);if(!o)return null;var n=o.split(T);return n[0]!==s?null:1*n[1]}function a(e,t,s){var o="TTF_"+e+"_"+t;if(null===s)return void w.erase(o);var n=i.globalSessionTracker.getSessionMetadata().globalSessionId,r=n+T+s;w.set(o,r)}function c(e){var t=e.npsRatings;return t=t>=0&&t<=6?"detractors":t>6&&t<=8?"passives":t>8?"promoters":"unknown",{starRating:e.starsRatings,npsResponse:t,formType:e.formType,formName:e.cfg.label,questionGroup:e.questionGroup}}var l={remove:function(){this.parentNode&&this.parentNode.removeChild(this)},hasClass:function(e){return this.className.indexOf(e)>-1},addClass:function(e){this.hasClass(e)||(this.className+=" "+e)},removeClass:function(e){this.className=(this.className||"").replace(e,"")},$:function(e){return this.querySelectorAll(e)},css:function(e){for(var t in e)e.hasOwnProperty(t)&&(this.style[t]=e[t])},getStyle:function(e){return window.getComputedStyle?window.getComputedStyle(this)[e]:this.currentStyle?this.currentStyle[e]:void 0}},d=function(e){if("string"==typeof e&&e.indexOf("<")==-1)return document.querySelectorAll(e);if("string"==typeof e){var t=document.createElement("div");t.innerHTML=e,e=t.firstChild}for(var i in l)l.hasOwnProperty(i)&&(e[i]=l[i]);return e},u=function(){var e=d('<img src="'+t.makeURI("/feedback/loader.gif")+'" class="auryc-loader" id="auryc-loader">');this.$el=e};u.prototype.center=function(e){var t=this.$el.parentNode.offsetWidth,i=(this.$el.parentNode.offsetHeight,this.$el.offsetWidth);this.$el.offsetHeight;this.$el.css({left:(t-i)/2+"px",top:e?(t-i)/2+"px":"auto"})},u.prototype.remove=function(){this.$el.parentNode.removeChild(this.$el)};var h={},f=function(e,s,o){this.cfg=e,this.cpps=o;var n,r=this,a="aurycFeedbackResultsCounter";if(this.fbVisible=!1,this.chatVisible=!1,this.badgeClicked=new i.AurycEvent,this.br=s,this.animationMove=4,this.interval=null,e.badgeTemplate){var c=i.base64url.decodeBase64(e.badgeTemplate);n=d(c),n.$(".__aurycFeedbackLabel")[0].innerHTML=e.label,e.chat&&t.domReady(function(){setTimeout(function(){r.handleChat(e,5)},0)})}else if(document.getElementById("__aurycFeedback_"+e.projectId))n=d(document.getElementById("__aurycFeedback_"+e.projectId)),n.className+="__aurycFeedback";else{if(e.counter)this.isIcon=!1,this.counter=0,sessionStorage.getItem(a)&&(this.counter=Math.round(parseFloat(sessionStorage.getItem(a))),this.counter=isNaN(this.counter)?0:this.counter),n=d('<div><span class="_aurycCounter"><span class="_aurycCounterInner">'+this.counter.toLocaleString()+'</span></span><span class="_aurycBadgeLabel __aurycFeedback" >'+e.label+"</span></div>");else{this.isIcon=!0;var l="",u="";s.isMobilePhone?(e.fontColor&&i.isValidColor(e.fontColor)&&(u='style="fill:'+e.fontColor+';position:relative;top:2px;"'),l='<div class="_aurycBadgeLabelMobile"'+u+">"+i.template.mobileBadgeLabel+"</div>"):(e.fontColor&&i.isValidColor(e.fontColor)&&(u='style="color:'+e.fontColor+'"'),l='<span class="_aurycBadgeLabel"'+u+'">'+e.label+"</span>"),n=d('<div style=""><div class="__aurycFeedback">'+l+"</div></div>")}var h=s.isMobilePhone?"bottomright":e.fblocation;n.addClass("_auryc _auryc"+e.fbtype+" _aurycBadge"+s.deviceType+" _auryc"+h),e.backgroundColor&&i.isValidColor(e.backgroundColor)&&n.css({backgroundColor:e.backgroundColor})}if(this.$el=n,e.badgeTemplate&&e.chat){var f=this.$el.$(".__aurycFeedback")[0];i.Bind(f,"feedback:click",function(){r._unhover(),r.badgeClicked.fire(e)})}else i.Bind(n,"feedback:click",function(){r._unhover(),r.badgeClicked.fire(e)});this.cfg.fbanimate&&(i.Bind(this.$el,"feedback:mouseenter",function(){r._hover()}),i.Bind(this.$el,"feedback:mouseleave",function(){r._unhover()}))};f.prototype._hover=function(){this.cfg.fbanimate&&this.$el.addClass("_aurycHover")},f.prototype._unhover=function(){this.cfg.fbanimate&&this.$el.removeClass("_aurycHover")},f.prototype.init=function(e){var t=this.$el.$(".__aurycFeedback"),i=this,s=i.cfg;if(e=e||function(){},this.setVisible(!1),t&&t.length>0&&e){if(i._unhover(),this.isIcon)y("templates/"+s.template+"/"+s.icon,function(t){return function(s,o){setTimeout(function(){i._unhover(),setTimeout(function(){t.addClass("_aurycAnimate"),e()},100),i._unhover()},100)}}(this.$el));else{i._unhover();var o=this.$el;setTimeout(function(){i._unhover(),setTimeout(function(){o.addClass("_aurycAnimate"),e()},250)},250)}"vertical"!=this.cfg.fbdirection||this.br.isMobilePhone||(this.cfg.fblocation.indexOf("right")>-1?this.$el.addClass("_aurycVertical_right"):this.$el.addClass("_aurycVertical_left")),this.cfg.fbfixed&&this.$el.addClass("_aurycFixed"),this.cfg.preview&&(s.badgeTemplate&&this.setChatVisible(!0),this.setVisible(!0))}this.applyCustomProperties(this.cfg)},f.prototype.setFeedbackVisible=function(e){var t,i=e?"block":"none";if(t=this.$el.className.indexOf("__aurycFeedback")>=0?[this.$el]:this.$el.$(".__aurycFeedback"),t&&t.length>0){var s=d(t[0]);s.css({display:i}),this.fbVisible=e,e?this.setVisible(e):(1===this.$el.children.length&&this.$el.children[0]===s&&this.setVisible(!1),this.chatVisible||this.setVisible(!1))}},f.prototype.setChatVisible=function(e){var t=e?"":"none",i=this.$el.$("__aurycChat");if(i&&i.length>0){var s=d(i[0]);s.css({display:t}),this.chatVisible=e,e?this.setVisible(e):(1===this.$el.children.length&&this.$el.children[0]===s&&this.setVisible(!1),this.fbVisible||this.setVisible(!1))}},f.prototype.setVisible=function(e){if(this.cfg.chat)return void(this.fbVisible=e);var t=e?"":"none";this.$el.css({display:t})},f.prototype.setCounter=function(e){this.numTween&&(this.numTween.stop(),this.counter=this.numTween.val);var t=this.$el.$("._aurycCounterInner")[0];this.numTween=new p(this.counter,e,i.proxy(function(e){t.innerHTML=Math.round(e).toLocaleString()},this)),this.numTween.go(1e3),sessionStorage.setItem("aurycFeedbackResultsCounter",e)},f.prototype.disableCounter=function(){var e=this.$el.$("._aurycBadgeImg")[0],i=this.cfg;console.log(i),e||(this.$el.$("._aurycCounterInner")[0].innerHTML="",d(this.$el.$("._aurycCounterInner")[0]).css({background:"none"}),e=d('<img style="position: relative;top: -2px;height: 19px;" src="'+t.makeURI("/feedback/templates/"+i.template+"/"+i.icon)+'" class="_aurycBadgeImg">'),this.$el.$("._aurycCounterInner")[0].appendChild(e))},f.prototype.enableCounter=function(){var e=this.$el.$("._aurycBadgeImg")[0];e&&(this.$el.$("._aurycCounterInner")[0].innerHTML="0",d(this.$el.$("._aurycCounterInner")[0]).css({background:"#F87473"}))},f.prototype.remove=function(){this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},f.prototype.removeFeedback=function(){var e=this.$el.$(".__aurycFeedback");if(e&&e.length>0){var t=d(e[0]);1===this.$el.children.length&&this.$el.children[0]===t?this.remove():this.$el.removeChild(t)}},f.prototype.handleChat=function(e,t){if("olark"===e.chat.vendor){"undefined"==typeof t&&(t=5);var i=this;if("function"!=typeof olark){if(t<=0)return;return void setTimeout(function(){i.handleChat(e,--t)},1e3)}olark("api.box.onShrink",function(){}),olark("api.box.onExpand",function(){})}},f.prototype.applyCustomProperties=function(e){function t(e){return!e||!("mobilePhone"===e.deviceType&&!o.br.isMobilePhone)}function i(e,t){for(var i=Object.keys(t),s=0;s<i.length;s++){var o=i[s],n=t[o];"style"===o?e.style.cssText+=n:e[o]=n}}if(e.customProperties&&e.customProperties.badge)for(var s=e.customProperties.badge,o=this,n=0;n<s.length;n++){var r=s[n];if(t(r.context))try{for(var a=document.querySelectorAll(r.cssSelector),c=0;c<a.length;c++){var l=a[c];i(l,r.properties)}}catch(d){console.log(d)}}};var p=function(e,t,i){this.from=e,this.to=t,this.diff=this.to-this.from,this.callback=i||function(){}};p.prototype={_tween:function(e){return--e*e*e+1},go:function(e){this.stop(),this.tm=e,this.startTime=new Date,this.timer=setInterval(i.proxy(function(){var e=new Date,t=e-this.startTime,i=Math.min(t/this.tm,1),s=this._tween(i);i>=1&&(clearInterval(this.timer),this.timer=null),this.val=s*this.diff+this.from,this.callback(this.val)},this),20)},stop:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}};var b=function(e,s,o){var n,r=e.mid||i.getParam("mid"),a=s.isIE&&s.browser.version<9;if(this.br=s,this.cpps=o,this.$content=d('<div class="aurycMainContainerMobile'+(a?" ie8":"")+'"></div>'),e.preview)n=this.cfg=e;else for(var c=0;c<e.instances.length;c++)if(e.instances[c].mid==r){n=this.cfg=e.instances[c];break}if(n){document.title=this.cfg.label;var l=this.sv=new L(this.cfg,this.cpps),u=this,h=!1,f=!1;l._getSurveyData(function(e){h=!0,u.survey=e,f&&u.renderSurvey()});var p=new i.JSONP({success:i.proxy(function(e){u.template=e,f=!0,h&&u.renderSurvey()},this)});p.get(t.makeURI("/feedback/templates/"+this.cfg.template+"/surveycontents.html"));var b=new i.JSONP({success:i.proxy(function(e){u.eptemplate=e},this)});b.get(t.makeURI("/feedback/templates/"+this.cfg.template+"/epilogue.html"))}};b.prototype._showThankyou=function(){var e=S(this.eptemplate,this.survey);this.$content.innerHTML=e;for(var t=this.$content.$("h1"),s=0;s<t.length;s++)d(t[s]).addClass("auryc-feedback__heading auryc-feedback__heading--h1");var o=this.$content.$(".auryc-close-button")[0];i.Bind(o,"feedback:click",function(){window.close()}),window.location.hash="FeedbackSubmitted"},b.prototype.renderSurvey=function(){var e=this,t=S(this.template,this.survey);this.$content.innerHTML=t,window.document.body.appendChild(this.$content),this.sv.bind(this.$content),this.$content.css({opacity:1}),this.sv.SurveySubmitted.subscribe(function(){e._showThankyou()})};var y=function(e,i){var s=function(){};i=i||s;var o=new Image;o.onload=function(){i(o.width,o.height)},o.onerror=function(){},e.indexOf("//")>-1?o.src=e:o.src=t.makeURI("/feedback/"+e),o.width&&(o.onload=o.onerror=s,i(o.width,o.height))},g=function(e){var t=window.location.hash.toString();if(t&&t.length>0)for(var i=t.split("&"),s=0;s<i.length;s++){var o=i[s].split("="),n=o[0].toLowerCase().trim();if(n==e.toLowerCase()){if(o.length>1)return decodeURIComponent(o[1]);break}}},I={};I.popups=[],I.getPopup=function(e){var t=I.popups;if(t.length>0){for(var i=0;i<t.length;i++)if(t[i].cfg.uid==e)return t[i];return!1}return!1},I.setCookie=function(e,t){var s=i.getRootDomain(window.location.hostname),o={path:"/",domain:s,secure:!1,encode:!0};if(!e)return void i._.console.error("throttle cookie is not defined");var n=new Date,r=t||90,a=n.getTime()+24*r*60*60*1e3;n.setTime(a),o.expires=n.toUTCString(),this.ckie=new i.Cookie(o),this.ckie.set(e,a)},I.hasPopup=function(){var e=I.popups;return e&&e.length>0},I.initialize=function(e,t,i){var s=I.getPopup(e.uid);s=new A(e,t,i),I.popups.push(s),s.SurveySubmitted.subscribe(function(){if(I.SurveySubmitted.fire(),e.launchedFromTimer){var t=e.surveyThrottles&&e.surveyThrottles.submitted||90,i=e.surveyThrottles&&e.surveyThrottles.cookie||"auryc.fbt";I.setCookie(i,t)}}),s.SurveyCanceled.subscribe(function(){if(e.launchedFromTimer){var t=e.surveyThrottles&&e.surveyThrottles.abandoned||7,i=e.surveyThrottles&&e.surveyThrottles.cookie||"auryc.fbt";I.setCookie(i,t)}})},I.SurveySubmitted=new i.AurycEvent;var v=function(e){this.br=e,this.previewmode=!!g("previewmode")&&g("previewmode").toLowerCase(),this.previewbadgemode=!!g("previewbadgemode")&&g("previewbadgemode").toLowerCase(),this.previewbadgemode?(this.cfg=g("cfg"),this.cfgObj=this.cfg?JSON.parse(this.cfg):{},this.template=this.cfgObj.template||"default"):this.previewmode&&(this.datauri=g("datauri"),this.mid=g("mid"),this.template=g("template")||"default",this.pid=g("pid"),this.backgroundColor=g("backgroundColor"),this.fontColor=g("fontColor"))};v.prototype.showBadge=function(){var e=this.cfgObj;_br=this.br,e.preview=!0;var s=function(){var t=new f(e,_br);document.body.appendChild(t.$el),t.init()};n(t.makeURI("/feedback/templates/"+this.template+"/userty.feedback.css"),i.proxy(function(e,t){if(e)if(this.cfg&&this.previewbadgemode)switch(this.previewbadgemode){case"desktop":this.cfgObj.delay&&this.cfgObj.delay>0?setTimeout(i.proxy(s,this),cfgObj.delay):s();break;case"tablet":this.cfgObj.delay&&this.cfgObj.delay>0?setTimeout(i.proxy(s,this),cfgObj.delay):s();break;case"phone":this.cfgObj.delay&&this.cfgObj.delay>0?setTimeout(i.proxy(s,this),cfgObj.delay):s()}else alert("you need to define config, datauri, and previewmode")},this))},v.prototype.showSurvey=function(){n(t.makeURI("/feedback/templates/"+this.template+"/userty.feedback.css"),i.proxy(function(e,t){if(e&&this.previewmode&&this.datauri&&this.template){var i={mid:this.mid,datauri:this.datauri,pid:this.pid,posturi:"",reporturi:"",popup:!1,autowhitelist:!0,preview:!0,template:this.template,backgroundColor:this.backgroundColor,fontColor:this.fontColor};switch(this.previewmode){case"desktop":case"tablet":case"phone":I.initialize(i,this.br);break;default:I.initialize(i,this.br)}}},this))};var m="enabled",w=new i.StorageFactory.getInstance(i.SYMBOLS.PERMANENT,"feedback"),C=new i.AurycEvent,k={feedbackEnabled:C,isFBProductEnabled:function(){return!0},setFeedbackEnabled:function(e){w.set(m,e),C.fire(e)},getFeedbackEnabled:function(){return w.get(m)!==!1}},_={exposePublicAPI:function(e,t){t&&(e.auryc||(e.aurycFeedbackAPI={}),e.userty||(e.userty={}),i.ext(e.aurycFeedbackAPI,t,!1),i.ext(e.userty,t,!1))}},S=function(e,t){var i;return(i=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"))(t||{})},M=function(e){function t(e){for(s=c,o=0;o<e.length;o++){for(r=e[o].replace(/^\s+|\s+$/g,"").replace(/[\*]{2,}/g,"*").toLowerCase(),i=[];r.indexOf("*")>-1;)r.indexOf("*")>0&&i.push(r.substr(0,r.indexOf("*"))),i.push("*"),r=r.substr(r.indexOf("*")+1);for(r.length>0&&i.push(r),a=!0,n=0;n<i.length;n++){if(r=i[n],"*"==r){if(i.length>n+1){if(n++,s.indexOf(i[n])==-1){a=!1;break}s=s.substr(s.indexOf(i[n])+i[n].length);continue}break}if(s.length<r.length){a=!1;break}if(s.substr(0,r.length)!=r&&s!=r+"/"){a=!1;break}s=s.substr(r.length)}if(a)return!0}return!1}var i,s,o,n,r,a,c=window._aurycURL||window.location.toString().toLowerCase();return!e.whitelistActive||t(e.whitelistData)},T=":",w=new i.StorageFactory.getInstance(i.SYMBOLS.PERMANENT,"feedback"),F=function(e,s,o){this.cfg=e,this.cpps=o,this.br=s,this.enabled=!0,this.delayedPopupTimer=!1,this.siteId=i.getConfig("siteid");var r=this;r.surveyTriggered=new i.AurycEvent,n(t.makeURI("/feedback/templates/"+(e.template||"default")+"/userty.feedback.css"),function(e,t){e&&r.setupBadge()})};F.prototype.disable=function(){this.enabled=!1,this.badge&&this.badge.removeFeedback()},F.prototype.setEnabled=function(e){this.enabled=!!e,this.badge&&(this.enabled?this.setupBadge():this.badge.setFeedbackVisible(!1))},F.prototype.setupBadge=function(){this.showBadge(),this.setupDelayedPopup(this.cfg)},F.prototype.showBadge=function(){this.badge=new f(this.cfg,this.br,this.cpps),document.body.appendChild(this.badge.$el),this.badge.init(),this.displayBadge(!0);var e=this;this.badge.badgeClicked.subscribe(function(){e.cfg.projectId;e.surveyTriggered.fire()})},F.prototype.displayBadge=function(e){var t=this.badge,s=this.cfg;if(handleScroll=function(){var e=i.GetScroll(window);k.getFeedbackEnabled()&&t.setFeedbackVisible(e.y>n)},"undefined"!=typeof s.projectId&&s.showBadge!==!1&&k.getFeedbackEnabled()||(e=!1),"D"===s.triggerbehavior)this.delayBadgeTimer&&clearTimeout(this.delayBadgeTimer),e&&(this.delayBadgeTimer=setTimeout(i.proxy(function(){k.getFeedbackEnabled()&&t.setFeedbackVisible(!0)},t),1e3*s.triggerdelayseconds));else if("T"===s.triggerbehavior||"S"===s.triggerbehavior)if(e){var o=i.GetSize(window);if(document.body.scrollHeight<=o.h)t.setFeedbackVisible(!0);else{var n=Math.min(o.h/4,(document.body.scrollHeight-o.h)/4);i.addEventListener(window,"scroll",handleScroll)}}else i.removeEventListener(window,"scroll",handleScroll),t.setFeedbackVisible(!1);else t.setFeedbackVisible(e)},F.prototype.setupDelayedPopup=function(e){if(!this.hasDelayedPopup(e))return!1;i._.console.warn("setting up delayed popup for project "+e.projectId+", delay: "+e.popupDelaySeconds+" seconds"),this.startTimer(this.siteId,e.projectId);var t=this;return i.events.unloadEvent.subscribe(function(){t.handlePageUnload()}),!0},F.prototype.handlePageUnload=function(){this.suspendTimer(this.siteId,this.cfg.projectId)},F.prototype.handleTimeout=function(){var e=this.cfg,t=this.siteId,i=!1,s=!0;E.isDelayedPopupActive(e)&&null!==r(t,e.projectId)&&(a(t,e.projectId,null),window.launchAurycFeedback(e.projectId,i,s))},F.prototype.handleNavigation=function(e){var t=this.cfg;this.badge&&this.displayBadge(e),this.hasDelayedPopup(t)&&(this.suspendTimer(this.siteId,t.projectId),e&&this.startTimer(this.siteId,t.projectId))},F.prototype.hasDelayedPopup=function(e){return!e.popupDelayEnabled||e.disabled?(i._.console.warn("delayed popup is not enabled in config for project "+e.projectId),!1):E.isDelayedPopupActive(e)?(i._.console.warn("delayed popup is enabled for project "+e.projectId+", delay: "+e.popupDelaySeconds+" seconds"),!0):(i._.console.warn("deplayed popup is not active in this session for project "+e.projectId),!1)},F.prototype.startTimer=function(e,t){if(!E.isFeedbackShown(this.config)){this.delayedPopupTimer&&clearTimeout(this.delayedPopupTimer);var i=r(e,t);i||0===i||(i=1e3*this.cfg.popupDelaySeconds,a(e,t,i));var s=this;this.startTime=(new Date).getTime(),this.delayedPopupTimer=setTimeout(function(){s.handleTimeout()},i)}},F.prototype.suspendTimer=function(e,t){var i=(new Date).getTime(),s=i-this.startTime,o=r(e,t);null!==o&&(newTimeRemain=o>s?o-s:0,a(e,t,newTimeRemain)),this.delayedPopupTimer&&clearTimeout(this.delayedPopupTimer),this.delayedPopupTimer=null};var E={platformOK:function(e,t){return!!i.featureToggle.isFeatureEnabled("platformtest","platformtest")||!(e.browser_cutoff[t.browser.name]&&t.browser.actualVersion<e.browser_cutoff[t.browser.name])&&!(e.platform_cutoff[t.os.name]&&t.os.version<e.platform_cutoff[t.os.name])},isConfigInstanceActive:function(e,t,s){if(e.disabled)return!1;if(100*Math.random()>=e.targetingcap)return!1;if(!(t.isMobile&&e.targetingdevicemobile||!t.isMobile&&e.targetingdevicedesktop))return!1;if("A"!==e.triggerpagefilter){var o="string"==typeof e.filterpages?e.filterpages.split(","):e.filterpages||[],n="string"==typeof e.filterpagesInclude?e.filterpagesInclude.split(","):e.filterpagesInclude||[];if("I"===e.triggerpagefilter&&!i.isUrlInList(s,n))return!1;if("E"===e.triggerpagefilter&&i.isUrlInList(s,o))return!1}e.topics=[];for(var r=!1,a=0;a<e.topics.length;a++)if(M(e.topics[a])){r=!0;break}return!(!r&&e.topics.length>0)},isDelayedPopupActive:function(e){if(this.isFeedbackShown(e))return!1;var t=!1,s=e.surveyThrottles;if(s){var o=s.sampling;if("undefined"==typeof o)return t;if(0===o)t=!1;else{var n=sessionStorage.getItem("auryc.fbt");if(n)t="t"===n;else{var r=100*Math.random();t=r<o,sessionStorage.setItem("auryc.fbt",t?"t":"f")}}}else i._.console.warn("no survey throttles are found. by default enabling"),t=!0;return t},isFeedbackShown:function(e){var t=e&&e.surveyThrottles&&e.surveyThrottles.cookie||"auryc.fbt";return!!i.Cookie.Get(t)&&(i._.console.warn("found survey throttle cookie. Not showing popup"),!0)}};if(!i.isProductEnabled("feedback")){i._.console.warn("fb: product disabled");var $={};return $.isFBProductEnabled=function(){return!1},void _.exposePublicAPI(window,$)}if(i.moduleStatus.isVisualEditorMode())return void i._.console.warn("fb: product disabled");var x=i.getProductConfig("feedback");x=i.ext({browser_cutoff:{IE:8,Safari:4,Firefox:11,Chrome:20,Opera:1e3},platform_cutoff:{Android:4,Winphone:7.4,iPod:7,iPhone:7,iPad:7}},x);var D=new i.Browser,j=new i.CPPS(null,"feedback");t.domReady(function(){function e(){E.platformOK(x,D)&&(t(n),i.events.navigationEvent.subscribe(function(){t(n)}))}function t(e){for(var t=function(e){return function(){I.initialize(e,D,j)}},s=0;s<e.length;s++){var o=e[s];if(E.isConfigInstanceActive(o,D,i.url()))switch(o.fbtype.toLowerCase()){case"badge":o.template||(o.template="default"),o.trigger?o.trigger.handleNavigation(!0):(o.trigger=new F(o,D,j,E),o.trigger.surveyTriggered.subscribe(t(o)))}else o.trigger&&o.trigger.handleNavigation(!1)}}var s=!!g("previewmode"),o=!!g("previewbadgemode"),n=i.getConfig("instances","feedback"),r=-1;s||o||(_.exposePublicAPI(window,k),k.feedbackEnabled.subscribe(e)),(n||s||o)&&D.browserReady.subscribe(function(){if(s){var t=new v(D);return void t.showSurvey()}if(o){var a=new v(D);return void a.showBadge()}if("IE"==D.browser.name&&D.browser.version<9)for(var c=0;c<n.length;c++)"vertical"==n[c].fbdirection&&(n[c].fbdirection="horizontal");e(),I.SurveySubmitted.subscribe(function(){}),window.launchAurycFeedback=function(e,t,s){var o=k.getFeedbackEnabled();if(o){var a=!1,c=new i.CPPS(null,"feedback"),l=0;if(e)for(l=0;l<n.length;l++)n[l].projectId==e&&(r=l,a=n[l]);else for(l=0;l<n.length;l++)if(!n[l].disabled){a=n[l];break}return a&&a.disabled?"This feedback has been disabled":a?void(I.hasPopup()?t&&(a.launchedFromTimer=s,I.initialize(a,D,c)):(a.launchedFromTimer=s,I.initialize(a,D,c))):"Error: projectId provided is not valid: "+e}}},!0,!0)});var A=function(e,t,s){this.cfg=e,this.br=t,this.cpps=s,this.init(),this.SurveySubmitted=new i.AurycEvent,this.SurveyCanceled=new i.AurycEvent};A.prototype.init=function(){var e=this,t=i.GetSize(window),s=!(!this.br.isMobile&&!this.cfg.popup&&t.w>500);this.chrome=new O(new L(this.cfg,this.cpps),this.br,this.cfg,s),this.chrome.SurveySubmitted.subscribe(function(){e.SurveySubmitted.fire()}),this.chrome.SurveyCanceled.subscribe(function(){e.SurveyCanceled.fire()})};var B=function(e,t,s){this.height=600,this.width=400,this.survey=e,this.cfg=t,this.cpps=e.cpps,this.SurveySubmitted=new i.AurycEvent,this.recordController=s};B.prototype._notified=function(e,t){var i=e.winRef.location+"";return i.indexOf(t)>-1},B.prototype.show=function(){if(!this.winRef){var e=i.globalSessionTracker.getSessionMetadata(),o=e.sessionId,n=e.globalSessionId,r=e.userId,a=s.getUBTTrackingInfo(),c=a.uri,l=a.siteid,d="/feedback/userty.feedbacksurvey.html?mid="+encodeURIComponent(this.survey.cfg.mid)+"&t="+encodeURIComponent(this.cfg.template||"default")+"&aurycUrl="+encodeURIComponent(window.location.href)+"&ns="+encodeURIComponent(this.cpps.site_id())+"&sid="+o+"&gsid="+n+"&uid="+r;c&&l&&(d+="&ubtUri="+encodeURIComponent(c)+"&ubtSiteId="+encodeURIComponent(l)),d=t.makeURI(d),ctx=this,this.winRef=window.open(d,"_system")}};var O=function(e,t,s,o){this.sv=e,this.cfg=e.cfg,this.instcfg=s,this.browser=t,this.mobileDevice=o,this.IE8=t.isIE&&t.browser.version<9,this.bodyOverflowStyle=null,this.bodyScrollTop=0,e.cfg.launchedFromTimer||this.add(),this._onTYPage=!1;var n=this,r=!1,a=!1;this.SurveySubmitted=new i.AurycEvent,this.SurveyCanceled=new i.AurycEvent,e._getSurveyData(function(t){r=!0,n.survey=t,e.cfg.launchedFromTimer&&n.add(),a&&n.renderSurvey()}),e.SurveySubmitStarted.subscribe(function(){n.$content.removeClass("aurycVisible"),n._showWait()}),e.cfg.popupDelayEnabled||e.networkError.subscribe(function(){n.$content.addClass("aurycVisible"),n._removeWait(),this.noserv=this._getTemplateContent(this.instcfg.template||"default","serviceunavailable"),this.$content.innerHTML=S(res,this.survey);for(var e=this.$content.$("h1"),t=0;t<e.length;t++)d(e[t]).addClass("auryc-feedback__heading auryc-feedback__heading--h1");this.positionModal();var s=this.$content.$(".auryc-close-button")[0];i.Bind(s,"feedback:click",function(){n.remove()})}),e.SurveySubmitted.subscribe(function(){n.$content.addClass("aurycVisible"),n._onTYPage=!0,n._showThankyou(),n.SurveySubmitted.fire(),n._removeWait()}),n._getModalTemplate(function(e){n.template=e,a=!0,r&&n.renderSurvey()}),this.eptemplate=this._getTemplateContent(this.instcfg.template||"default","epilogue")};O.prototype._getTemplateContent=function(e,t){var s=window["aurycFBTemplate_"+e+"_"+t];return i.base64url.decodeBase64(s)},O.prototype._showThankyou=function(){this.instcfg&&(this.instcfg.fontColor&&i.isValidColor(this.instcfg.fontColor)&&(this.survey.meta.btnFontColor=this.instcfg.fontColor),this.instcfg.backgroundColor&&i.isValidColor(this.instcfg.backgroundColor)&&(this.survey.meta.btnBackgroundColor=this.instcfg.backgroundColor));var e=this,t=S(this.eptemplate,this.survey);this.$content.innerHTML=t;for(var s=this.$content.$("h1"),o=0;o<s.length;o++)d(s[o]).addClass("auryc-feedback__heading auryc-feedback__heading--h1");this.positionModal();var n=this.$content.$(".auryc-close-button")[0];i.Bind(n,"feedback:click",function(){e.remove()})},O.prototype._showWait=function(){this._removeWait(),this._wait=new u,this.$el.appendChild(this._wait.$el),this._wait.center();var e=i.GetScroll(window),t=i.GetSize(window);this._wait.$el.css({top:e.y+(t.h-this._wait.$el.offsetHeight)/2+"px"})},O.prototype._removeWait=function(){this._wait&&(this._wait.remove(),this._wait=null)},O.prototype._getModalTemplate=function(e){this.template=this._getTemplateContent(this.instcfg.template||"default","surveycontents"),e&&e(this.template)},O.prototype.remove=function(e){this.$el.remove(),this.enableBodyOverflow(!0,e)},O.prototype.trackAbanonded=function(e){i.SubPub.publish(i.SYMBOLS.EVENT.FEEDBACKTRACKER,{eventType:i.SYMBOLS.UBAEVENTTYPE.CUSTOM_EVENT,eventName:"Feedback Abandoned",tagName:"FeedbackAbandoned",eventProperties:{formid:this.cfg.projectId,name:"Feedback Abandoned",et:"abandoned"}})},O.prototype.add=function(e){e=e||window;var s=e.document.body,o=e.document.documentElement,n=Math.max(s.scrollHeight,s.offsetHeight,o.clientHeight,o.scrollHeight,o.offsetHeight);this.$el=d('<div class="aurycModalContainer"></div>'),this.$el.css({height:n});var r=(this.$el,this.sv.cfg,this),a=d('<div class="aurycModalBackFace"></div>'),c=d('<div class="aurycModalChrome"></div>');if(this.browser.isIE&&8==this.browser.browser.version&&a.addClass("aurycIE8"),!this.cfg.preview){i.Bind(a,"feedback:click",i.proxy(function(e){(this.survey||this.sv.networkError.didFire)&&(this._onTYPage||(this.trackAbanonded(r),r.SurveyCanceled.fire()),this.remove())},this));var l=function(e){27==e.keyCode&&(r._onTYPage||(r.trackAbanonded(r),r.SurveyCanceled.fire()),r.remove(),i.Unbind(document.body,"feedback:keyup",l))};i.Bind(document.body,"feedback:keyup",l),i.Bind(c,"feedback:click",function(e){var t=e.target;t&&t==c&&(r._onTYPage||(r.trackAbanonded(r),r.SurveyCanceled.fire()),r.remove())})}var u=this.head=d('<div class="aurycModalContent"></div>'),h=d('<div class="aurycModalHead"></div>'),f=d('<img src="'+t.makeURI("/feedback/templates/"+(this.instcfg.template||"default")+"/closeBtn"+(this.IE8?"IE8":"")+".png")+'" class="aurycModalCloseButton">');this.$head=h,h.appendChild(f),u.appendChild(h),this.$content=d('<div class="aurycModalInnerContent"></div>'),u.appendChild(this.$content),c.appendChild(u),this.$el.appendChild(a),this.$el.appendChild(c),e.document.body.appendChild(this.$el),this.enableBodyOverflow(!1,e),i.Bind(f,"feedback:click",this.handleClose.bind(this)),setTimeout(function(){a.addClass("_aurycActive")},20),this.cfg.launchedFromTimer||this._showWait()},O.prototype.enableBodyOverflow=function(e,t){t=t||window;if(e)this.bodyOverflowStyle&&(d(t.document.body).css(this.bodyOverflowStyle),this.browser.isMobile&&(d(t.document.body).scrollTop=this.bodyScrollTop),this.bodyOverflowStyle=null,this.bodyScrollTop=0);else{var i=d(t.document.body);this.bodyOverflowStyle||(this.bodyOverflowStyle={overflow:i.getStyle("overflow")},this.browser.isMobile&&(this.bodyOverflowStyle.position=i.getStyle("position"),this.bodyScrollTop=i.scrollTop)),i.css({overflow:"hidden"}),this.browser.isMobile&&setTimeout(function(){i.css({position:"fixed"})},200)}},O.prototype.renderSurvey=function(){this._onTYPage=!1,this.cfg.preview||i.SubPub.publish(i.SYMBOLS.EVENT.FEEDBACKTRACKER,{eventType:i.SYMBOLS.UBAEVENTTYPE.CUSTOM_EVENT,eventName:"Feedback Started",tagName:"FeedbackStarted",eventProperties:{formid:this.cfg.projectId,name:"Feedback Started",et:"started"}}),this._removeWait(),this.$head.addClass("aurycVisible"),this.instcfg&&(this.instcfg.fontColor&&i.isValidColor(this.instcfg.fontColor)&&(this.survey.meta.btnFontColor=this.instcfg.fontColor),this.instcfg.backgroundColor&&i.isValidColor(this.instcfg.backgroundColor)&&(this.survey.meta.btnBackgroundColor=this.instcfg.backgroundColor));var e=S(this.template,this.survey);this.$content.innerHTML=e,this.sv.render(this,this.$content)},O.prototype.positionModal=function(){var e=i.GetSize(window),t=this.$content.offsetHeight;this.browser.isMobile||this.head.css({marginTop:Math.max(0,(e.h-t-50)/2)+"px"})},O.prototype.display=function(e){return this.enableBodyOverflow(!e),e?(this.$content.removeClass("aurycVisible"),this.$el.style.display="",this.positionModal(),this.$content.addClass("aurycVisible"),void this.sv.SurveyUIUpdated.fire()):void(this.$el.style.display="none")},O.prototype.handleClose=function(){this.cfg.preview||(this.trackAbanonded(this),this.SurveyCanceled.fire()),this.remove()},i.validation={},i.validation.emailRegEx=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,i.validation.isEmail=function(e){return i.matchRegexp(e,i.validation.emailRegEx)},i.validation.isEmpty=function R(e){return R(e.trim())},i.matchRegexp=function(e,t){return!J(e)||N(e)||t.test(e)};var J=function(e){return null!==e&&void 0!==e},N=function(e){return""===e},L=function(e,t){this.cfg=e,this.data=null,this.cpps=t,this.$el=null,this.$primaryRatingMsgContainer=null,this.rated=!0,this.SurveyUIUpdated=new i.AurycEvent,this.SurveySubmitStarted=new i.AurycEvent,this.SurveySubmitted=new i.AurycEvent,this.networkError=new i.AurycEvent,this.dataError=!1,this.starsRatings=!1,this.npsRatings="unknown",this.formType=null,this.questionGroup=null};L.prototype._getDefaultData=function(){
return"XJ2ZXkiOnsiY29udGVudCI6eyJtZXRhIjp7ImluZm8iOnsibmFtZSI6Ik5ldyBGZWVkYmFjayBmb3JtIDIiLCJtaWQiOiJhN2RnaFFjR1M0T20zd1VEZm00N0JXbXhBS1RKNnJZcyIsInBpZCI6IkdBSDZBMGtwcXVYRDlId1IyQ2hmWVpFS2tvQXBwVFpJIiwibGFuZ2NvZGUiOiJFTiIsImN1cnJlbnRseWFjdGl2ZSI6IjEiLCJsb2dvMWdyYXBoaWMiOiIiLCJsb2dvMWdyYXBoaWNoZWlnaHQiOjAsImxvZ28yZ3JhcGhpYyI6IiIsImxvZ28yZ3JhcGhpY2hlaWdodCI6MCwic3VydmV5dGl0bGUiOiJGZWVkYmFjayBTdXJ2ZXkiLCJwcm9sb2d1ZXRleHQiOiJZb3VyIG9waW5pb24gd2lsbCBoZWxwIHVzIHByb3ZpZGUgYSBiZXR0ZXIgb25saW5lIGV4cGVyaWVuY2UuIiwiZXBpbG9ndWV0ZXh0IjoiV2UgQXBwcmVjaWF0ZSBZb3VyIEZlZWRiYWNrIiwiYWx0bW9kZWxpbnN0YW5jZWlkIjoiIiwiaXNtdWx0aWxhbmd1YWdlIjoiMCIsImNoYW5uZWx0eXBlIjoiMSJ9LCJjc3MiOiIiLCJleHQtaW5mbyI6eyJyYXRpbmciOiJQbGVhc2UgcHJvdmlkZSBhIGJhc2ljIHJhdGluZyIsImNob29zZSI6IkNob29zZeKApiIsInN1Ym1pdCI6IlN1Ym1pdCIsIm9rIjoiT0siLCJlbWFpbGVtcHR5IjoiRW1haWwgY2Fubm90IGJlIGVtcHR5IiwiZW1haWx2YWxpZCI6IlBsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsIGFkZHJlc3MiLCJucHNaZXJvIjoiTm90IEF0IEFsbCBMaWtlbHkiLCJucHNUZW4iOiJFeHRyZW1lbHkgTGlrZWx5IiwieW91ckFuc3dlciI6IllvdXIgQW5zd2VyIiwicG93ZXJlZEJ5IjoiUG93ZXJlZCBieSIsImxlZnQiOiIke05VTX0gY2hhcmFjdGVycyBsZWZ0In0sInJ1bGUtaW5mbyI6IiJ9LCJtYWluIjp7Im1xIjoiIiwibWEiOiIiLCJjcSI6eyJxc3RuIjpbeyJpZCI6IlNIQTAwOTQyMzgiLCJyIjoiMSIsImlzaGlkZGVuIjoiMCIsImhjIjoiMCIsInF0IjoiNCIsImR0IjoiMiIsImhvIjoiMCIsIm0iOiIxIiwicmFuZCI6IjAiLCJwb3JkZXIiOiIxIiwidHh0IjoiUGxlYXNlIHJhdGUgeW91ciBleHBlcmllbmNlIG9uIG91ciB3ZWJzaXRlLiIsImxibCI6IiJ9LHsiaWQiOiJTSEEwMDk0MjM5IiwiciI6IjEiLCJpc2hpZGRlbiI6IjEiLCJoYyI6IjAiLCJxdCI6IjgiLCJkdCI6IjYiLCJobyI6IjAiLCJtIjoiMSIsInJhbmQiOiIwIiwicG9yZGVyIjoiMiIsInR4dCI6IkhvdyBsaWtlbHkgYXJlIHlvdSB0byByZWNvbW1lbmQgRmVuZyBUZXN0IEluYy4gdG8gYSBmcmllbmQgb3IgY29sbGVhZ3VlPyIsImxibCI6IiJ9LHsiaWQiOiJTSEEwMDk0MjQwIiwiciI6IjEiLCJpc2hpZGRlbiI6IjAiLCJoYyI6IjEiLCJxdCI6IjIiLCJkdCI6IjEiLCJobyI6IjAiLCJtIjoiMSIsInJhbmQiOiIwIiwicG9yZGVyIjoiMyIsInR4dCI6IldoYXQgaXMgeW91ciBmZWVkYmFjayByZWdhcmRpbmc_IiwibGJsIjoiIn1dfSwiY2EiOnsiYW5zIjpbeyJpZCI6IlNIQTAwOTQyMzhBMDAxIiwicWlkIjoiU0hBMDA5NDIzOCIsImRsIjoiMCIsImR2IjoiMSIsImxibCI6IiIsInZhbCI6IjEuMDAwMDAwMDAifSx7ImlkIjoiU0hBMDA5NDIzOUEwMDEiLCJxaWQiOiJTSEEwMDk0MjM5IiwiZGwiOiIwIiwiZHYiOiIxIiwibGJsIjoiTm90IEF0IEFsbCBMaWtlbHkiLCJ2YWwiOiIwLjAwMDAwMDAwIn0seyJpZCI6IlNIQTAwOTQyNDBBMDAxIiwicWlkIjoiU0hBMDA5NDI0MCIsImRsIjoiMSIsImR2IjoiMCIsImxibCI6Ik5ldyBRdWVzdGlvbiBHcm91cCAxIiwidmFsIjoiMS4wMDAwMDAwMCJ9LHsiaWQiOiJTSEEwMDk0MjM4QTAwMiIsInFpZCI6IlNIQTAwOTQyMzgiLCJkbCI6IjAiLCJkdiI6IjEiLCJsYmwiOiIiLCJ2YWwiOiIyLjAwMDAwMDAwIn0seyJpZCI6IlNIQTAwOTQyMzlBMDAyIiwicWlkIjoiU0hBMDA5NDIzOSIsImRsIjoiMCIsImR2IjoiMSIsImxibCI6IiIsInZhbCI6IjEuMDAwMDAwMDAifSx7ImlkIjoiU0hBMDA5NDIzOEEwMDMiLCJxaWQiOiJTSEEwMDk0MjM4IiwiZGwiOiIwIiwiZHYiOiIxIiwibGJsIjoiIiwidmFsIjoiMy4wMDAwMDAwMCJ9LHsiaWQiOiJTSEEwMDk0MjM5QTAwMyIsInFpZCI6IlNIQTAwOTQyMzkiLCJkbCI6IjAiLCJkdiI6IjEiLCJsYmwiOiIiLCJ2YWwiOiIyLjAwMDAwMDAwIn0seyJpZCI6IlNIQTAwOTQyMzhBMDA0IiwicWlkIjoiU0hBMDA5NDIzOCIsImRsIjoiMCIsImR2IjoiMSIsImxibCI6IiIsInZhbCI6IjQuMDAwMDAwMDAifSx7ImlkIjoiU0hBMDA5NDIzOUEwMDQiLCJxaWQiOiJTSEEwMDk0MjM5IiwiZGwiOiIwIiwiZHYiOiIxIiwibGJsIjoiIiwidmFsIjoiMy4wMDAwMDAwMCJ9LHsiaWQiOiJTSEEwMDk0MjM4QTAwNSIsInFpZCI6IlNIQTAwOTQyMzgiLCJkbCI6IjAiLCJkdiI6IjEiLCJsYmwiOiIiLCJ2YWwiOiI1LjAwMDAwMDAwIn0seyJpZCI6IlNIQTAwOTQyMzlBMDA1IiwicWlkIjoiU0hBMDA5NDIzOSIsImRsIjoiMCIsImR2IjoiMSIsImxibCI6IiIsInZhbCI6IjQuMDAwMDAwMDAifSx7ImlkIjoiU0hBMDA5NDIzOUEwMDYiLCJxaWQiOiJTSEEwMDk0MjM5IiwiZGwiOiIwIiwiZHYiOiIxIiwibGJsIjoiIiwidmFsIjoiNS4wMDAwMDAwMCJ9LHsiaWQiOiJTSEEwMDk0MjM5QTAwNyIsInFpZCI6IlNIQTAwOTQyMzkiLCJkbCI6IjAiLCJkdiI6IjEiLCJsYmwiOiIiLCJ2YWwiOiI2LjAwMDAwMDAwIn0seyJpZCI6IlNIQTAwOTQyMzlBMDA4IiwicWlkIjoiU0hBMDA5NDIzOSIsImRsIjoiMCIsImR2IjoiMSIsImxibCI6IiIsInZhbCI6IjcuMDAwMDAwMDAifSx7ImlkIjoiU0hBMDA5NDIzOUEwMDkiLCJxaWQiOiJTSEEwMDk0MjM5IiwiZGwiOiIwIiwiZHYiOiIxIiwibGJsIjoiIiwidmFsIjoiOC4wMDAwMDAwMCJ9LHsiaWQiOiJTSEEwMDk0MjM5QTAxMCIsInFpZCI6IlNIQTAwOTQyMzkiLCJkbCI6IjAiLCJkdiI6IjEiLCJsYmwiOiIiLCJ2YWwiOiI5LjAwMDAwMDAwIn0seyJpZCI6IlNIQTAwOTQyMzlBMDExIiwicWlkIjoiU0hBMDA5NDIzOSIsImRsIjoiMCIsImR2IjoiMSIsImxibCI6IkV4dHJlbWVseSBMaWtlbHkiLCJ2YWwiOiIxMC4wMDAwMDAwMCJ9XX0sImNhc2V0IjoiIiwibmNxIjp7InFzdG4iOlt7ImlkIjoiU0hBMDA5NDI0MSIsInF0IjoiMSIsImR0IjoiMiIsInIiOiIxIiwicGlkIjoiU0hBMDA5NDI0MCIsImFpZCI6IlNIQTAwOTQyNDBBMDAxIiwiYyI6IiIsIm0iOiIxIiwicmFuZCI6IjAiLCJ0eHQiOiJEZWZhdWx0IFF1ZXN0aW9uIn1dfSwiY2FnIjoiIiwib2NhIjoiIiwiZXh0Y3FhdHRyIjoiIiwicGFnZXMiOiIiLCJwYWdlLXRpdGxlcyI6IiJ9fX19eyJzd"},L.prototype._transpileJSONDef=function(e){function t(e,t){for(var i=0;i<t.length;i++){var s=t[i];e[s]&&(e[s]=e[s].replace(u,"<").replace(h,">"))}}var i,s,o,n,r={meta:e.survey.content.meta.info,ext:e.survey.content.meta["ext-info"],notopic:[],topics:[]},a=e.survey.content.main,c=a.cq,l=a.ca,d=a.ncq,u=/&lt;/gi,h=/&gt;/gi,f={};if(d&&"string"!=typeof d||(d={qstn:[]}),d.qstn&&"undefined"==typeof d.qstn.length&&(d.qstn=[d.qstn]),this.cfg.autowhitelist=!0,!this.cfg.autowhitelist&&this.cfg.topics.length>0)for(var p=0;p<this.cfg.topics.length;p++){var b=this.cfg.topics[p];M(b)&&(f[b.answerId]=!0)}for(t(r.meta,["epiloguetext","prologuetext"]),i=0;i<c.qstn.length;i++)if(o=c.qstn[i],"0"===o.ishidden)for(t(o,["txt","lbl"]),r.notopic.push(o),o.answers=[],s=0;s<l.ans.length;s++)n=l.ans[s],n.qid==o.id&&(r.topics.push(n),o.answers.push(n));for(i=0;i<d.qstn.length;i++)for(o=d.qstn[i],t(o,["txt","lbl"]),o.answers=[],s=0;s<l.ans.length;s++)n=l.ans[s],n.qid==o.id&&o.answers.push(n);if(!this.cfg.autowhitelist&&this.cfg.topics.length>0){for(s=0;s<r.topics.length;s++)f[r.topics[s].id]||r.topics.splice(s--,1);for(s=0;s<r.notopic.length;s++)if("2"==r.notopic[s].qt)for(i=0;i<r.notopic[s].answers.length;i++)f[r.notopic[s].answers[i].id]||r.notopic[s].answers.splice(i--,1)}for(i=0;i<r.topics.length;i++){var y=r.topics[i];if(y.questions=[],d.qstn)for(s=0;s<d.qstn.length;s++)d.qstn[s].aid==y.id&&(t(d.qstn[s],["txt","lbl"]),y.questions.push(d.qstn[s]))}var g=[];for(i=0;i<r.notopic.length;i++)"2"==r.notopic[i].qt&&(g=r.notopic[i].answers);return r.vistopics=g,r},L.prototype._processSurveyData=function(e,t,i){clearTimeout(e._surveyReqTimer),e.data=e._transpileJSONDef(JSON.parse(t));var s=e.data.meta,o=!!s.logo2graphic,n=!!s.logo1graphic,r=!1,a=!1,c=function(){i&&i(e.data)};o||n?(o&&y(s.logo2graphic,function(e,t){r=!0,(!n||n&&a)&&c()}),n&&y(s.logo1graphic,function(e,t){a=!0,(!o||o&&r)&&c()})):c()},L.prototype._getSurveyData=function(e){var t=this,s={fid:t.cfg.mid,cachebust:(new Date).getTime()};t.cfg.pid&&(s.pid=t.cfg.pid),t._surveyReqTimer=setTimeout(i.proxy(function(){t.dataError=!0;var s=i.base64url.decodeBase64(t._getDefaultData());t._processSurveyData(t,s,e)},t),5e3);var o=t.cfg.datauri.replace(/^https?:(\/\/.*)/g,window.location.protocol+"$1"),n=function(s){if(!t.networkError.didFire){var o=i.base64url.decodeBase64(s);t._processSurveyData(t,o,e)}},r=function(s){t.dataError=!0;var o=i.base64url.decodeBase64(t._getDefaultData());t._processSurveyData(t,o,e)};i.AjaxTransport.ajax("GET",o,s,n,r)},L.prototype._postSurveyData=function(e){var t=this;if(this.cfg.preview||this.dataError)return void setTimeout(function(){e&&e()},100);var s=this._serialize();if(!s)return void this.$modal.handleClose(this.$modal);var o=i.base64url.encodeBase64(s),n=function(s){var o=JSON.parse(s).respondentId,n=t.cfg.projectId;i.SubPub.publish(i.SYMBOLS.EVENT.FEEDBACKTRACKER,{eventType:i.SYMBOLS.UBAEVENTTYPE.CUSTOM_EVENT,eventName:"Feedback Submitted",tagName:"FeedbackSubmitted",eventProperties:i._.extend({formid:n,name:"Feedback Submitted",respid:o,et:"submitted"},c(t))}),e&&e()},r=function(t){sessionStorage.setItem("usertyFeedbackSubmitted","true"),e&&e()},a=this.cfg.posturi.replace(/^https?:(\/\/.*)/g,window.location.protocol+"$1");i.AjaxTransport.ajax("POST",a,o,n,r,!0,"application/json")},L.prototype._bindStars=function(e){e=d(e);for(var t=e.$("fieldset.auryc-star-rating"),s=this,o=function(e){return function(){for(var t=0;t<e.length;t++)d(e[t]).removeClass("_aurycHover")}},n=function(e,t){return function(e){for(var i=!1,s=e.srcElement||e.explicitOriginalTarget,o=0;o<t.length;o++)i?d(t[o]).removeClass("_aurycHover"):i||d(t[o]).addClass("_aurycHover"),t[o]==s&&(i=!0)}},r=function(e,t,i){return function(o){i&&(s.rated=!0);for(var n=!1,r=function(){e.removeClass("_aurycRatingSet")},a=o.srcElement||o.originalTarget,c=0;c<t.length;c++)n?d(t[c]).removeClass("auryc-star-rating__star--fill"):n||d(t[c]).addClass("auryc-star-rating__star--fill"),t[c]==a&&(n=!0,a.checked=!0),e.addClass("_aurycRatingSet"),setTimeout(r,250);s.showValidationMessage(s.$primaryRatingMsgContainer,!s.rated)}},a=0;a<t.length;a++){var c=d(t[a]),l=c.$("label"),u=c.$("input");0===a&&(s.$primaryRatingMsgContainer=d(s.$el.$(".auryc-feedback__primary")[0].parentElement)),i.Bind(c,"feedback:mouseleave",o(l));for(var h=0;h<l.length;h++)i.Bind(l[h],"feedback:mouseenter",n(c,l));for(var f=0;f<u.length;f++)i.Bind(u[f],"feedback:click",r(c,u,0===a))}},L.prototype._bindNps=function(e){e=d(e);var t=e.$(".nps-rating__badges"),s="";this.cfg.backgroundColor&&i.isValidColor(this.cfg.backgroundColor)&&(s=this.cfg.backgroundColor);var o="";this.cfg.fontColor&&i.isValidColor(this.cfg.fontColor)&&(o=this.cfg.fontColor);for(var n=function(e){return function(t){for(var i=t.srcElement||t.originalTarget,n=0;n<e.length;n++)e[n]!=i&&e[n]!=i.parentNode||h[n].checked||(d(e[n]).style.backgroundColor=s,d(e[n]).style.color=o)}},r=function(e){return function(t){for(var i=t.srcElement||t.originalTarget,s=0;s<e.length;s++)e[s]!=i&&e[s]!=i.parentNode||h[s].checked||(d(e[s]).style.backgroundColor="",d(e[s]).style.color="")}},a=function(e,t){return function(i){for(var n=i.srcElement||i.originalTarget,r=0;r<e.length;r++)e[r]==n||e[r]==n.parentNode?(d(e[r]).addClass("aurycNpsRatingChecked"),d(e[r]).style.backgroundColor=s,d(e[r]).style.color=o,t[r].checked=!0):(d(e[r]).removeClass("aurycNpsRatingChecked"),d(e[r]).style.backgroundColor="",d(e[r]).style.color="",t[r].checked=!1)}},c=0;c<t.length;c++)for(var l=d(t[c]),u=l.$("label"),h=l.$("input"),f=0;f<u.length;f++)i.Bind(u[f],"feedback:mouseenter",n(u,h)),i.Bind(u[f],"feedback:mouseleave",r(u)),i.Bind(u[f],"feedback:click",a(u,h))},L.prototype._createTempStyle=function(){var e="aurycCheckedOverride";if(this.cfg.backgroundColor&&i.isValidColor(this.cfg.backgroundColor)){var t=this.cfg.backgroundColor,s=document.createElement("style");s.type="text/css";var o=".auryc-feedback .auryc-feedback__cbradio."+e+":before { color: "+t+';content: "\\f14a"; opacity: 1.0; } .auryc-feedback .auryc-feedback__cbradio.auryc-feedback__cb-radio.'+e+":before { color: "+t+';content: "\\f111"; opacity: 1.0; } ';s.styleSheet?s.styleSheet.cssText=o:s.appendChild(document.createTextNode(o)),document.getElementsByTagName("head")[0].appendChild(s)}else e=null;return e},L.prototype._bindCBs=function(e){e=d(e);for(var t=this._createTempStyle(),s=e.$(".auryc-feedback__cbox"),o=function(e){return function(i){for(var s=e.$("label"),o=0;o<s.length;o++){var n=d(s[o]),r=n.$("input[type=checkbox]")[0];r.checked?t?n.addClass(t):n.addClass("aurycChecked"):t?n.removeClass(t):n.removeClass("aurycChecked")}}},n=0;n<s.length;n++)for(var r=d(s[n]),a=r.$("input[type=checkbox]"),c=0;c<a.length;c++)i.Bind(a[c],"feedback:change",o(r))},L.prototype._bindRadios=function(e){e=d(e);for(var t=this._createTempStyle(),s=e.$(".auryc-feedback__radio"),o=function(e){return function(i){for(var s=e.$("label"),o=0;o<s.length;o++){var n=d(s[o]),r=n.$("input[type=radio]")[0];r.checked?t?n.addClass(t):n.addClass("aurycChecked"):t?n.removeClass(t):n.removeClass("aurycChecked")}}},n=0;n<s.length;n++)for(var r=d(s[n]),a=r.$("input[type=radio]"),c=0;c<a.length;c++)i.Bind(a[c],"feedback:change",o(r))},L.prototype._bindSelects=function(e){e=d(e);for(var t=e.$(".auryc-feedback__select"),s=this,o=function(e,t){return function(i){var s=d(t).$("option")[t.selectedIndex];e.innerHTML=s.innerHTML}},n=function(){s._updateSelects(e)},r=0;r<t.length;r++){var a=d(t[r]),c=a.$("select")[0],l=a.$("div.auryc-feedback__select-button")[0];d(c).css({height:a.offsetHeight+"px"}),i.Bind(c,"feedback:change",o(l,c))}this.SurveyUIUpdated.subscribe(function(){setTimeout(n,100)})},L.prototype._updateSelects=function(e){e=d(e);for(var t=e.$(".auryc-feedback__select"),i=0;i<t.length;i++){var s=d(t[i]),o=s.$("select")[0];s.$("div.auryc-feedback__select-button")[0];s.offsetHeight>0&&d(o).css({height:(s.offsetHeight||38)+"px"})}},L.prototype._bindTextAreas=function(e){e=d(e);for(var t=e.$(".auryc-feedback__textarea"),s=function(e){var t=e.target||e.srcElement,i=parseInt(t.getAttribute("aurycmaxlength"),10),s=t.value.replace(/\s+/g," ").length,o=i-s,n=d(t.parentNode),r=n.$(".auryc-feedback__textarea--count")[0];if(r.innerHTML=Math.max(0,o),o<0)return t.value=t.value.substr(0,t.value.length+o),!1},o=function(e){var t=e.target||e.srcElement,i=parseInt(t.getAttribute("aurycmaxlength"),10),s=t.value.replace(/\s+/g," ").length,o=i-s-1,n=e.keyCode;if(o<0&&8!=n&&16!=n&&!(n>=37&&n<=41))return e.preventDefault(),!1},n=0;n<t.length;n++){var r=d(t[n]),a=r.$("textarea")[0];r.$(".auryc-feedback__textarea--count")[0];/^[0-9]+$/.test(a.getAttribute("aurycmaxlength"))&&(i.Bind(a,"feedback:keydown",o),i.Bind(a,"feedback:keyup",s),i.Bind(a,"feedback:blur",s))}},L.prototype._bindEmails=function(e){function t(e){var t=e.target||e.srcElement,o="",n=t.getAttribute("required");n&&i.isEmpty(t.value)?o=s.data.ext.emailempty:i.validation.isEmail(t.value)||(o=s.data.ext.emailvalid);var r=d(t.parentElement);r.$(".auryc-validation-block")[0].innerHTML=o,s.showValidationMessage(r,o.length>0)}e=d(e);for(var s=this,o=e.$(".auryc-feedback__email"),n=0;n<o.length;n++){var r=d(o[n]),a=r.$("input")[0];i.Bind(a,"feedback:blur",t)}},L.prototype._serialize=function(){this.starsRatings=!1,this.npsRatings="unknown",this.questionGroup=null;var e=i.globalSessionTracker.getSessionMetadata(),t={mid:this.cfg.mid,globalId:e.globalSessionId,sessionId:e.sessionId,url:window.location.toString().indexOf("&aurycUrl")>-1?i.getParam("aurycUrl"):window.location.toString(),responses:[]},s=t.responses,o=this.$el.$(".auryc-visible__topic .auryc-feedback__block, .auryc-feedback__question");if(1==this.data.vistopics.length)for(var n=0;n<this.data.notopic.length;n++){var r=this.data.notopic[n];if("2"==r.qt){s.push({questionId:r.id,answerId:r.answers[0].id});break}}for(var a=0;a<o.length;a++){var c=o[a].getAttribute("questionid"),l=o[a].getAttribute("data-question-type");if(c)if("5"==l)for(var u=d(o[a]),h=u.$("input"),f=0;f<h.length;f++){var p=h[f].getAttribute("questionid");h[f].checked&&s.push({questionId:c,answerId:p})}else{var b={questionId:c},y=d(o[a]),g=y.$("input"),I=y.$("textarea"),v=y.$("select");if(g.length>0){var m=g[0].getAttribute("type");if("radio"==m){for(var w=0;w<g.length;w++)if(g[w].checked){b.answerId=g[w].value;var C=g[w].getAttribute("label");C&&(b.answerText=decodeURIComponent(C)),"auryc-feedback__question"===y.className.trim()&&5===g.length&&(this.starsRatings=w+1),"auryc-nps__container auryc-feedback__question"===y.className.trim()&&11===g.length&&(this.npsRatings=w)}}else"hidden"==m?b.answerId=g[0].value:b.answerText=g[0].value}else if(I.length>0){var k=I[0].value.replace(/\s+/g," ");k.length>=1e3&&(k=k.substr(0,999)),b.answerText=k}else if(v.length>0&&v[0].selectedIndex>0&&(b.answerId=v[0].value,this.questionGroup=v[0].selectedOptions[0].value,!b.answerId||0===b.answerId.length))continue;s.push(b)}}var _=this.cpps.all();for(var S in _)s.push({questionId:S,answerText:_[S]});this.cfg.version&&(t.version=this.cfg.version);var M=this.$el.$(".auryc-feedback__canvas canvas")[0];if(M)try{t.image=M.toDataURL("image/png").replace("image/png","image/octet-stream")}catch(T){i._.console.log(T)}var F=null;this.data.vistopics.length>0&&(F=this.data.vistopics[0].qid);var E=!0,$=t.responses;for(a=0;a<$.length;a++)if($[a].questionId!==F&&($[a].answerId||$[a].answerText&&$[a].answerText.trim())){E=!1;break}return E?null:t=JSON.stringify(t)},L.prototype.showValidationMessage=function(e,t){if(e){var i=d(e.$(".auryc-validation-block")[0]);t?i.css({display:"block"}):i.css({display:"none"})}},L.prototype.isValid=function(){if(!this.rated)return!1;var e=this.$el.$(".auryc-visible__topic")[0];if(e){errorMsgs=e.$(".auryc-validation-block");for(var t=0;t<errorMsgs.length;t++)if("none"!==d(errorMsgs[t]).getStyle("display"))return!1}return!0},L.prototype.bind=function(e){function t(t){for(var i=e.$(".auryc-feedback__topic"),o=0;o<i.length;o++)d(i[o]).removeClass("auryc-visible__topic");try{d(document.getElementById("topk_"+t)).addClass("auryc-visible__topic"),s._topic=t}catch(n){}s.SurveyUIUpdated.fire()}var s=this;s.submitted=!1,s._bindSelects(e),s._bindStars(e),s._bindNps(e),s._bindTextAreas(e),s._bindCBs(e),s._bindRadios(e),s._bindEmails(e);for(var o=e.$(".auryc-headingzone h1"),n=0;n<o.length;n++)d(o[n]).addClass("auryc-feedback__heading auryc-feedback__heading--h1");i.Bind(e.$(".auryc-submit-feedback__button")[0],"click",function(e){return s.showValidationMessage(s.$primaryRatingMsgContainer,!s.rated),s.isValid()&&!s.submitted&&(s.SurveySubmitStarted.fire(),s.submitted=!0,s._postSurveyData(function(){s.SurveySubmitted.fire()})),e&&e.preventDefault&&e.preventDefault(),!1}),i.Bind(e.$(".auryc-feedback__screenshot")[0],"click",function(e){return s.takeScreenshot(),e&&e.preventDefault&&e.preventDefault(),!1}),i.Bind(e.$(".auryc-feedback__general")[0],"click",function(e){return s.showFeedback(),e&&e.preventDefault&&e.preventDefault(),!1});var r=e.$(".auryc-topic__selector")[0];i.Bind(r,"feedback:change",function(e){return function(i){t(e.value)}}(r)),1==this.data.vistopics.length&&(d(document.getElementById("topk_"+this.data.vistopics[0].id)).addClass("auryc-visible__topic"),this._updateSelects(e))},L.prototype.canShowScreenshot=function(e){return!(e.isIE&&e.browser.version<9)&&(this.cfg.specificFormEnable!==!0&&window.location.hash.indexOf("screenshot")<0,!1)},L.prototype.render=function(e,t){t=d(t),this.$el=t,this.$modal=e,this.bind(t),this.canShowScreenshot(e.browser)?(d(this.$el.$(".aurcy-feedback__selection")[0]).addClass("aurycVisibleContent"),d(this.$el.$(".aurcy-feedback__content")[0]).removeClass("aurycVisibleContent"),this.$modal.$el.addClass("formSelection"),this.$modal.display(!0)):this.showFeedback()},L.prototype.showFeedback=function(){d(this.$el.$(".aurcy-feedback__selection")[0]).removeClass("aurycVisibleContent"),d(this.$el.$(".aurcy-feedback__content")[0]).addClass("aurycVisibleContent"),this.$modal.$el.removeClass("formSelection"),this.$modal.display(!0),this.formType="feedbackform"},L.prototype.takeScreenshot=function(){this.$modal.$el.removeClass("formSelection");var e="Click on any part of this page you would like to give feedback about.";i.screenshot.mark(e,this.updateScreenshot.bind(this),this.$modal),this.$modal.display(!1),this.formType="screenshot"},L.prototype.updateScreenshot=function(e){var t=this.$el.$(".auryc-feedback__canvas")[0];t.innerHTML="",t.appendChild(e.canvas),document.getElementById(e.answerDomId).click(),document.getElementsByClassName("auryc-submit-feedback__button")[0].click()}});